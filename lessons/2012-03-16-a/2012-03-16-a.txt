% Polyhedral geometry 2
% Computational Visual Design ([CVD-Lab](https://github.com/cvd-lab)), DIA, "Roma Tre" University, Rome, Italy 
% Computational Graphics 2012



# Affine spaces

## Affine space

The idea of affine space corresponds to that of a
set of points where the **displacement** from a point $\p{x}$ to another
point $\p{y}$ is obtained by summing a vector $\v{v}$ to the $\p{x}$ point.



## Definition

A set ${\cal A}$ of points is called an **affine space** modeled on
the vector space ${\cal V}$ if there is a function 
$$
{\cal A}\times{\cal V}\rightarrow{\cal A}:(\p{x},\v{v})\mapsto \p{x}+\v{v}
$$
called **affine action**\index{Affine!action}, with the properties:


#. $(\p{x}+\v{v})+\v{w} = \p{x}+(\v{v}+\v{w})$ for each $\p{x}\in{\cal A}$ and each $\v{v},\v{w}\in{\cal V}$;

#. $\p{x}+\p{0}=\p{x}$ for each $\p{x}\in{\cal A}$, where $\p{0}\in{\cal V}$ is the null vector;

#. for each pair $\p{x},\p{y}\in{\cal A}$ there is a unique $(\p{y}-\p{x})\in{\cal V}$ such that
$$
\p{x}+(\p{y}-\p{x})=\p{y}.
$$

## Dimension

The affine space ${\cal A}$  is said of *dimension* $n$ if modeled
on a vector space ${\cal V}$ of dimension $n$.


## Vector sum vs affine action


\begin{figure}
\centerline{\includegraphics[width=\linewidth]{figs/somma.pdf}}
\caption{(a) Vector sum and difference are given by the parallelogram rule
(b)~associativity of displacement (point and vector sum) in an affine
space}
\end{figure}


## Operations on vectors and points

* The **addition** of vectors is a primitive operation in a vector space.

* The **difference** of vectors is defined through the two primitive
operations:
$$
\v{v}_1-\v{v}_2=\v{v}_1+(-1)\v{v}_2.
$$

* Addition and difference of vectors are geometrically produced by the
*parallelogram rule*

* notice also the *associative property* of the affine action on a point space.


## Operations on vectors and points

The sum of a set $\{\v{v}_i\}$ of vectors ($i=1,\ldots,n$) can be
geometrically obtained, in an affine space:

* by setting $\p{p}_0=\p{0}$
* $\p{p}_i=\p{p}_{i-1}+\v{v}_i$, 
* so that $$ \sum_{i} \v{v}_i= \p{p}_n-\p{p}_0 $$

### Remark

#. the *addition of points* is **not** defined;
#. the *difference of two points* is a **vector**;
#. the *sum of a point and a vector* is a **point**.


## Positive, affine and convex combinations

Three types of combinations of vectors or points can be defined. They 
lead to the concepts of **cones**, **hyperplanes** and **convex sets**, 
respectively.


## Positive combination

Let $\p{v}_0,\ldots,\p{v}_d\in{\cal \R}^n$ and $\alpha_0,
\ldots,\alpha_d\in \R^{+}\cup\{0\}$.  

	
The vector
$$
\alpha_0 \p{v}_0 + \cdots + \alpha_d \p{v}_d = \sum_{i=0}^d \alpha_i \p{v}_i
$$
is called a **positive combination** of such vectors.  

	
The set of all the positive combinations of
$\{\p{v}_0,\ldots,\p{v}_d\}$ is called the **positive hull** of $\{\p{v}_0,\ldots,\p{v}_d\}$ and
denoted *$\pos \{\p{v}_0,\ldots,\p{v}_d\}$.* 

	
This set is also called the **cone** generated by the given vectors

## Affine combination

Let $\p{p}_0,\ldots,\p{p}_d\in{\E}^n$ and $\alpha_0,
\ldots,\alpha_d\in \R$, such that $\alpha_0  + \cdots + \alpha_d =1$.

The point
$$
\sum_{i=0}^d \alpha_i \p{p}_i
:= \p{p}_0 + \sum_{i=1}^d \alpha_i (\p{p}_i - \p{p}_0)
$$
is called an **affine combination** of the points $\p{p}_0,\ldots,\p{p}_d$.

## Affine combination

The set of all affine combinations of
$\{\p{p}_0,\ldots,\p{p}_d\}$ is an **affine
subspace**, denoted by *$\aff \{\p{p}_0,\ldots,\p{p}_d\}$* 

It is easy to verify that:
$$
\aff \{\p{p}_0,\ldots,\p{p}_d\} = 
\p{p}_0 + \lin\{ \p{p}_1-\p{p}_0,\ldots,\p{p}_d-\p{p}_0 \}.
$$

## Affine combination

#. The **dimension** of an affine subspace is the dimension of the 
corresponding linear vector space. 

#. Affine subspaces of $\E^{d}$ with 
dimensions 0, 1, 2 and $d-1$ are called **points**, **lines**, 
**planes** and **hyperplanes**, respectively.

#. Affine subspaces are also called **flats**.

### Double description

Every affine subspace can be described either as 

- the *intersection* of affine *hyperplanes*, or as 
- the *affine hull* of a finite set of *points*.


## Convex combination

Let $\p{p}_0,\ldots,\p{p}_d\in{\E}^n$ and *$\alpha_0,\ldots,\alpha_d \geq 0$*, 
with *$\alpha_0  + \cdots + \alpha_d =1$*.

The point 
$$
\alpha_0 \p{p}_0 + \cdots + \alpha_d \p{p}_d = \sum_{i=0}^d \alpha_i \p{p}_i
$$
is called a **convex combination** of points $\p{p}_0,\ldots,\p{p}_d$.

A **convex** combinations is both *positive* and *affine*.  

## Convex hull

The set of **all**
convex combinations of $\{\p{p}_0,\ldots,\p{p}_d\}$ is a convex set,
called **convex hull** of
$\{\p{p}_0,\ldots,\p{p}_d\}$, and is denoted by *$\conv\{\p{p}_0,\ldots,\p{p}_d\}$*.

### Properties

- the convex hull of a set of points is the *intersection of all convex sets* that contain them
- the convex hull of a set of points is the *smallest set* that contains them


## Computational Geometry

* the *convex hull* of a set of points is a basic problem of **Computational Geometry** [(see David Mount's *Lecture Notes*)](http://www.cs.umd.edu/~mount/754/Lects/754lects.pdf)

* Computational Geometry develops **efficient algorithms** for problems about *basic geometrical objects*: points, line segments, polygons, polyhedra, etc

* since very large datasets contain tens or hundreds of millions of points, the focus is on *computational complexity*

* for large data sets, the difference between $O(n^2)$ and $O(n \log n)$ may be between **days** and **seconds** of computation.




## Convex hull algorithms: Gift wrapping (or Jarvis march) 


$O(nh)$: where $n$ is the number of points and $h$ is the number of points on the convex hull


\begin{figure}
\centerline{\includegraphics[width=0.4\linewidth]{figs/jarvis.png}}
\caption{begin with $i=0$, at point $p_0$ known to be on the convex hull, and select the point $p_{i+1}$ such that all points are to the right of the line $[p_i, p_{i+1}]$}
\end{figure}




## Linear, affine and convex independence


A set of **vectors** is said to be **linearly independent** if none of them can be
obtained as a linear combination of the other ones.

Analogously, a set of **points** is said **affinely/convexely independent** if none of them can be
obtained as an affine/convex combination of the other ones, respectively.



## Affine combination

The set of **affine combinations** of *two
affinely independent (i.e. distinct) points*
$\p{p}_0,\p{p}_1\in{\E}^n$, $\p{p}_{0}\not=\p{p}_{1}$, is **their line**:
\begin{eqnarray*}
\alpha_0 \p{p}_0 + \alpha_1 \p{p}_1 &:=& (1- \alpha_1) \p{p}_0 + \alpha_1 \p{p}_1\\
&=& \p{p}_0 + \alpha_1 (\p{p}_1 - \p{p}_0)
\end{eqnarray*}
Remember that a difference of points is a vector, and that the sum of
a point and a vector is a point.


## Convex combination (examples)

#. The set of **convex combinations** of *two affinely independent (i.e. distinct) points* $\p{p}_0,\p{p}_1\in{\E}^n$, $\p{p}_{0}\not=\p{p}_{1}$, is the **line segment** joining $\p{p}_0$ with $\p{p}_1$:

\begin{eqnarray*}
\p{p}(\beta)&=& (1-\beta) \p{p}_0 + \beta \p{p}_1\\
&=& \p{p}_0 + \beta (\p{p}_1 - \p{p}_0), \qquad 0\leq\beta\leq 1
\end{eqnarray*}

$$
\p{p}(0) = \p{p}_0,\quad\mbox{and}\quad \p{p}(1) = \p{p}_1.
$$

#. The set of **affine combinations** of *three affinely independent (i.e. not aligned) points* is their **plane**.  

#. The set of **convex combinations** of *three affinely independent points* is their triangle, i.e. the **triangle**
whose vertices are those points.



## Plasm.js: Exercise 10  (Plane for three points)

Let $\p{p}_0, \p{p}_1, \p{p}_2 \in\E^3$ be **three non collinear points**, i.e. such that:
$$
\det\mat{\p{p}_0 & \p{p}_1 & \p{p}_2} \not= 0.
$$

The vector $\v{n}$, normal to the bundle of planes parallel to the 3 points, may be computed as
$$
\v{n} = (\p{p}_1 - \p{p}_0) \times (\p{p}_2 - \p{p}_0)
$$

The Cartesian equation $ax+by+cz+d=0$ of the plane for $\p{p}_0, \p{p}_1, \p{p}_2$,
with
$$
a = n_x, \quad b = n_y, \quad c = n_z
$$ is finally fixed by imposing the passage for one of such points---say $\p{p}_0=(x_0,y_0,z_0)^T$:
$$ 
ax_0 + by_0 + cz_0 + d = 0 \quad\mbox{and hence}\quad d = -(n_x\,x_0 + n_y\,y_0 + n_z\,z_0)
$$



## Affine coordinates

Given a point $\p{p}\in \aff \{\p{p_0},\ldots,\p{p_d} \}$, the scalars
$\alpha_0,\ldots,\alpha_d$ such that:
$$
\p{p} = \alpha_0\p{p_0} +\cdots +\alpha_d\p{p_d},
$$
with $\alpha_0 + \cdots +\alpha_d = 1$,
are called **affine coordinates** of $\p{p}$. 

Affine coordinates
are **unique** if the points $\p{p_0},\ldots,\p{p_d}$ are affinely
independent.

### Remarks

#. A $d$-flat of $\E^n$, $(1\leq d\leq n)$ is parameterized by $d+1$ *affine coordinates*
#. Points of the $d$-flat are associated bijectively with such $(d+1)$-tuples of coordinates


## Convex coordinates

Given a point $\p{p}\in \conv \{\p{p_0},\ldots,\p{p_d} \}$, the scalars
$\alpha_0,\ldots,\alpha_d$ such that:
$$
\p{p} = \alpha_0\p{p_0} +\cdots +\alpha_d\p{p_d},
$$
with $\alpha_0,\ldots,\alpha_d \geq 0$ and $\alpha_0 + \cdots +\alpha_d = 1$,
are called **convex coordinates** of $\p{p}$. 

Convex coordinates
are **unique** if the points $\p{p_0},\ldots,\p{p_d}$ are affinely
independent.




## Affine coordinates

The **affine coordinates** of $\E^d$ are 
$(d+1)$-tuples of numbers summing to one.


A linear mapping between $\E^d$ points and the $\E^{d+1}$ 
hyperplane $x_1 + x_2 + \cdots + x_{d+1} = 0$ is used.


The **transformation of coordinates** depends 
on $d+1$ affinely independent points $(\p{p}_0,\ldots, \p{p}_d)\in \E^d$ that,
embedded in $x_{d}=1$, are mapped to the standard basis:
$$
[\T{I}] = [\T{T}] \mat{
	\p{p}_0 & \ldots & \p{p}_d \\
	1 & \ldots & 1\\}
$$
so that
$$
[\T{T}] = \mat{
	\p{p}_0 & \ldots & \p{p}_d \\
	1 & \ldots & 1\\}^{-1}
$$






